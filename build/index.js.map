{"version":3,"sources":["../server/index.js"],"names":["express","require","app","fileupload","cookies","greenlock","path","use","urlencoded","json","set","useTempFiles","tempFileDir","setup","Promise","resolve","reject","db","connect","err","init","packageRoot","join","__dirname","configDir","maintainerEmail","cluster","serve","main","module"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;AACA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,GAAG,GAAGF,OAAO,EAAnB;;AACA,IAAIG,UAAU,GAAGF,OAAO,CAAC,oBAAD,CAAxB;;AACA,IAAIG,OAAO,GAAGH,OAAO,CAAC,eAAD,CAArB;;AACA,IAAII,SAAS,GAAGJ,OAAO,CAAC,mBAAD,CAAvB;;AACA,IAAMK,IAAI,GAAGL,OAAO,CAAC,MAAD,CAApB,C,CAEA;AACA;AACA;AACA;AACA;AACA;;;AAEAC,GAAG,CAACK,GAAJ,CAAQP,OAAO,CAACQ,UAAR,EAAR;AACAN,GAAG,CAACK,GAAJ,CAAQP,OAAO,CAACS,IAAR,EAAR;AACAP,GAAG,CAACQ,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AACAR,GAAG,CAACK,GAAJ,CAAQJ,UAAU,CAAC;AAACQ,EAAAA,YAAY,EAAE,IAAf;AAAqBC,EAAAA,WAAW,EAAE;AAAlC,CAAD,CAAlB,E,CACA;AACA;;AACAV,GAAG,CAACK,GAAJ,CAAQH,OAAO,EAAf,E,CAEA;AACA;AACA;AACA;;AAEO,IAAMS,KAAK,GAAG,SAARA,KAAQ,GAAM;AACvB,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpCC,IAAAA,EAAE,CAACC,OAAH,CAAW,UAACC,GAAD,EAAS;AAChB,UAAIA,GAAJ,EAAS,OAAOH,MAAM,CAACG,GAAD,CAAb;AAET,8BAAOjB,GAAP;AACA,mCAAQA,GAAR;AAEAG,MAAAA,SAAS,CAACe,IAAV,CAAe;AACXC,QAAAA,WAAW,EAAEf,IAAI,CAACgB,IAAL,CAAUC,SAAV,EAAoB,IAApB,CADF;AAEXC,QAAAA,SAAS,EAAE,cAFA;AAGXC,QAAAA,eAAe,EAAE,sBAHN;AAIXC,QAAAA,OAAO,EAAE;AAJE,OAAf,EAKGC,KALH,CAKSzB,GALT;AAOAa,MAAAA,OAAO;AACV,KAdD;AAeH,GAhBM,CAAP;AAiBH,CAlBM;;;;AAoBP,IAAId,OAAO,CAAC2B,IAAR,KAAiBC,MAArB,EAA6B;AACzBhB,EAAAA,KAAK;AACN","sourcesContent":["import routes from \"./routes/routes\";\nimport statics from \"./routes/staticfiles\";\nimport * as db from \"./helpers/db\"\n//import verify from \"./helpers/auth\"\nconst express = require(\"express\");\nconst app = express();\nvar fileupload = require(\"express-fileupload\");\nvar cookies = require(\"cookie-parser\");\nvar greenlock = require(\"greenlock-express\");\nconst path = require(\"path\");\n\n//var http = require(\"http\");\n//var https = require(\"https\");\n//var fs = require(\"fs\");\n//var privatekey = fs.readFileSync(\"sslcert/server.key\", \"utf-8\");\n//var certificate = fs.readFileSync(\"sslcert/server.crt\", \"utf-8\");\n//var credentials = {key: privatekey, cert:certificate};\n\napp.use(express.urlencoded());\napp.use(express.json());\napp.set('view engine', 'ejs');\napp.use(fileupload({useTempFiles: true, tempFileDir: \"tmp/\"}));\n//app.use(express.static('tmp'))\n//app.use(verify, express.static(path.join(__dirname,'privatetmp')));\napp.use(cookies());\n\n// app.use((req,res) => {\n//     console.log(req.headers);\n//     res.status(200).end();\n// })\n\nexport const setup = () => {\n    return new Promise((resolve, reject) => {\n        db.connect((err) => {\n            if (err) return reject(err);\n\n            routes(app);\n            statics(app);\n\n            greenlock.init({\n                packageRoot: path.join(__dirname,\"..\"),\n                configDir: \".greenlock.d\",\n                maintainerEmail: \"jbb2170@columbia.edu\",\n                cluster: true,\n            }).serve(app);\n            \n            resolve();\n        })\n    })\n}\n\nif (require.main === module) {\n    setup();\n  }"],"file":"index.js"}